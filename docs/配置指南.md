# Claude Code 声音提示配置指南

本文档介绍如何为 Claude Code 配置声音提示功能，让 AI 在完成任务时播放提示音，无需一直盯着屏幕等待。

## 配置概述

- **适用系统**: macOS
- **配置文件**: `~/.claude/settings.json`
- **提示音**: 使用 macOS 系统自带音效

## 快速安装

使用一键安装脚本（推荐）：

```bash
curl -O https://raw.githubusercontent.com/yourusername/claude-code-sounds/main/install-claude-sounds.sh
chmod +x install-claude-sounds.sh
./install-claude-sounds.sh
```

详见项目主页：https://github.com/yourusername/claude-code-sounds

## 手动配置步骤

### 1. 创建必要的目录结构

创建脚本存放目录：

```bash
mkdir -p ~/.local/bin
```

### 2. 创建播放脚本

创建三个脚本文件，分别用于不同的提示场景。

#### 任务完成提示音脚本

创建文件 `~/.local/bin/claude-task-done.sh`：

```bash
#!/bin/bash
# 任务完成时播放的提示音
afplay /System/Library/Sounds/Glass.aiff
```

#### 用户提交提示音脚本

创建文件 `~/.local/bin/claude-user-prompt.sh`：

```bash
#!/bin/bash
# 用户提交提示时播放的提示音
afplay /System/Library/Sounds/Hero.aiff
```

#### 用户询问提示音脚本

创建文件 `~/.local/bin/claude-ask-user.sh`：

```bash
#!/bin/bash
# Claude 向用户询问时播放的提示音
afplay /System/Library/Sounds/Ping.aiff
```

#### 添加执行权限

```bash
chmod +x ~/.local/bin/claude-task-done.sh
chmod +x ~/.local/bin/claude-user-prompt.sh
chmod +x ~/.local/bin/claude-ask-user.sh
```

### 3. 配置 settings.json

编辑 `~/.claude/settings.json` 文件，添加 hooks 配置。

完整的配置文件示例：

```json
{
  "env": {
    "ANTHROPIC_AUTH_TOKEN": "your-token-here",
    "ANTHROPIC_BASE_URL": "your-api-url",
    "API_TIMEOUT_MS": "3000000",
    "CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC": 1
  },
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "/Users/YOURNAME/.local/bin/claude-task-done.sh"
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "/Users/YOURNAME/.local/bin/claude-user-prompt.sh"
          }
        ]
      }
    ],
    "PermissionRequest": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "/Users/YOURNAME/.local/bin/claude-ask-user.sh"
          }
        ]
      }
    ]
  }
}
```

**注意**: 请将路径中的 `/Users/YOURNAME` 替换为你的实际用户名路径。

## Hook 事件说明

### PostToolUse
- **触发时机**: Claude Code 执行工具操作后
- **提示音**: Glass.aiff（清脆的玻璃声）
- **用途**: 表示任务已完成，可以查看结果

### UserPromptSubmit
- **触发时机**: 用户提交新的提示时
- **提示音**: Hero.aiff（英雄登场音效）
- **用途**: 表示 Claude Code 已接收你的指令，开始处理

### PermissionRequest
- **触发时机**: Claude Code 需要向用户请求权限时
- **提示音**: Ping.aiff（清脆的提示音）
- **用途**: 表示 Claude Code 等待你的授权确认

## 测试配置

### 测试提示音脚本

手动执行脚本测试是否能正常播放声音：

```bash
# 测试任务完成提示音
~/.local/bin/claude-task-done.sh

# 测试用户提交提示音
~/.local/bin/claude-user-prompt.sh

# 测试用户询问提示音
~/.local/bin/claude-ask-user.sh
```

### 验证 Hook 配置

重启 Claude Code 后，发送一条简单消息，应该能听到提示音。

## 自定义提示音

### 使用自定义音频文件

如果你想使用自己的音乐或音效：

1. **准备音频文件**
   - 将音频文件放在任意位置，例如 `~/Music/custom.mp3`

2. **修改播放脚本**

编辑 `~/.local/bin/claude-task-done.sh`，将音频文件路径改为你自己的文件：

```bash
#!/bin/bash
# 任务完成时播放的提示音
afplay ~/Music/custom.mp3
```

或者创建一个通用的播放脚本，支持参数传入音频文件路径：

创建文件 `~/.local/bin/claude-play-sound.sh`：

```bash
#!/bin/bash
# 通用的音频播放脚本，接受音频文件路径作为参数
afplay "$1"
```

添加执行权限：
```bash
chmod +x ~/.local/bin/claude-play-sound.sh
```

3. **更新 settings.json**

使用通用脚本：

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "/Users/YOURNAME/.local/bin/claude-play-sound.sh /Users/YOURNAME/Music/custom.mp3"
          }
        ]
      }
    ]
  }
}
```

### macOS 系统音效推荐

macOS 提供了多种系统音效，位于 `/System/Library/Sounds/` 目录：

- `Glass.aiff` - 清脆的玻璃声（推荐用于任务完成）
- `Hero.aiff` - 英雄登场音效（推荐用于开始任务）
- `Ping.aiff` - 清脆的提示音（推荐用于权限请求）
- `Basso.aiff` - 低沉提示音
- `Blow.aiff` - 吹气声
- `Bottle.aiff` - 瓶子声
- `Frog.aiff` - 青蛙叫声
- `Funk.aiff` - 时尚音效
- `Morse.aiff` - 摩斯电码
- `Pop.aiff` - 气泡声
- `Purr.aiff` - 呼噜声
- `Sosumi.aiff` - 经典 Mac 音效
- `Submarine.aiff` - 潜水艇声
- `Tink.aiff` - 清脆的金属声

查看所有可用音效：

```bash
ls /System/Library/Sounds/*.aiff
```

## 常见问题

### 1. 没有声音

检查以下项目：
- 系统音量是否开启
- 脚本是否有执行权限（`ls -l ~/.local/bin/`）
- 音频文件路径是否正确
- 使用 `afplay` 命令直接测试音频文件

### 2. Hook 没有触发

确认以下事项：
- `settings.json` 文件位置是否正确（必须在 `~/.claude/` 目录下）
- JSON 格式是否正确（可以使用 JSON 验证工具检查）
- Hook 事件名称是否正确
- 重启 Claude Code 使配置生效

### 3. 查看 Hook 日志

如果脚本中添加了日志输出，可以查看：

```bash
tail -f /tmp/claude-hook.log
```

### 4. 查看支持的 Hook 事件

在 Claude Code 中输入：

```
/hooks
```

查看当前版本支持的所有 Hook 事件。

## 高级配置

### 为不同工具配置不同提示音

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "/Users/YOURNAME/.local/bin/claude-task-done.sh"
          }
        ]
      },
      {
        "matcher": "Edit",
        "hooks": [
          {
            "type": "command",
            "command": "/Users/YOURNAME/.local/bin/claude-user-prompt.sh"
          }
        ]
      }
    ]
  }
}
```

### 组合多个 Hook

可以在同一个事件中配置多个 hook：

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "/Users/YOURNAME/.local/bin/claude-task-done.sh"
          },
          {
            "type": "command",
            "command": "echo 'Task completed at $(date)' >> ~/claude-tasks.log"
          }
        ]
      }
    ]
  }
}
```

## 配置文件位置总结

| 文件/目录 | 路径 | 说明 |
|-----------|------|------|
| 配置文件 | `~/.claude/settings.json` | Claude Code 主配置文件 |
| 脚本目录 | `~/.local/bin/` | 存放自定义脚本 |
| 音频目录 | `~/Music/` 或任意位置 | 存放自定义音频文件 |
| 日志文件 | `/tmp/claude-hook.log` | Hook 执行日志（可选） |

## 参考资料

- 项目主页: https://github.com/yourusername/claude-code-sounds
- Claude Code 官方文档: 通过 `/help` 命令查看

---

**配置完成后记得重启 Claude Code 以使更改生效！**
